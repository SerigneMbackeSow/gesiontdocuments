<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:400,600&display=swap" rel="stylesheet">
    <!-- Ajoutez ce lien pour Bootstrap (si vous ne l'avez pas déjà ajouté) -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <style>
        .d-flex {
            display: flex;
        }

        .card-buttons {
            display: flex;
            justify-content: space-between;
            gap: 0.25rem; /* Espace entre les boutons */
            margin-top: 0.5rem; /* Ajoute un espace entre le contenu de la carte et les boutons */
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .contenus-courants, .contenus-globals {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .card {
            width: 10rem; /* Largeur des cartes */
            height: auto; /* Hauteur automatique pour permettre l'ajustement en fonction du contenu */
            min-height: 12rem; /* Hauteur minimale pour que la carte ait une taille constante */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 0.5rem; /* Ajoute du padding autour du contenu de la carte */
            box-shadow: 0 0 1rem rgba(0, 0, 0, 0.1); /* Ajoute une ombre légère pour améliorer la visibilité */
            border-radius: 0.5rem; /* Ajoute des coins arrondis */
            background-color: #fff; /* Assure que la carte a un fond blanc */
            overflow: hidden; /* Assure que le contenu ne déborde pas de la carte */
        }

        .card-img-top {
            width: 100%; /* Largeur de l'image */
            height: 7rem; /* Hauteur de l'image */
            object-fit: cover; /* Maintient le ratio d'aspect de l'image */
            margin-bottom: 0.5rem; /* Ajoute un espace entre l'image et le texte */
        }

        .card-body {
            flex: 1; /* Permet au corps de la carte d'occuper l'espace restant */
            padding: 0.5rem; /* Ajoute du padding autour du texte */
            overflow: hidden; /* Assure que le texte ne déborde pas du conteneur */
        }

        .card-text {
            font-size: 0.875rem; /* Réduit la taille de la police pour le texte */
            margin: 0; /* Supprime les marges pour éviter les débordements */
            overflow: hidden; /* Assure que le texte ne déborde pas du conteneur */
            text-overflow: ellipsis; /* Ajoute des points de suspension si le texte est trop long */
            white-space: nowrap; /* Empêche le texte de passer à la ligne suivante */
        }

        .btn {
            width: 50%; /* Assure que les boutons utilisent toute la largeur de la carte */
            margin-top: 0.5rem; /* Ajoute un espace entre le texte et les boutons */
            font-size: 0.50rem; /* Réduit la taille de la police des boutons */
            padding: 0.5rem; /* Ajoute du padding interne aux boutons */
            box-sizing: border-box; /* Inclut le padding et la bordure dans la largeur totale du bouton */
        }


        .disabled-link {
            pointer-events: none;
            opacity: 0.5;
        }


    </style>
    <link rel="stylesheet" href=" /static/fonts/icomoon/style.css">
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.7.2/font/bootstrap-icons.min.css"
          rel="stylesheet">

    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


    <link rel="stylesheet" href="/static/assets/styletra/css/owl.carousel.min.css">
    <!-- Pour les icones -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/static/assets/styletra/css/bootstrap.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <!-- For icons -->
    <!-- Style -->
    <!--<link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/style1.css">-->
    <link href="/static/assets/styletra/css/style.css" rel="stylesheet">
    <link href="/static/assets/styletra/css/style1.css" rel="stylesheet">
    <title>TOM-MEDLOG GED</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            let fetchInterval;
            let notificationCount = 0;

            function fetchData() {
                const paragraphElement = document.getElementById('monutil');
                const paragraphContent = paragraphElement.textContent;

                $.ajax({
                    url: '/doc/fetch_permission/18',
                    method: 'GET',
                    data: {id_user: paragraphContent},
                    success: function (response) {
                        if (response.data) {
                            updateTable(response.data);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error("Error fetching data: ", status, error);
                    }
                });
            }

            function updateTable(data) {
                let tableBody = $("#your-table-id tbody");
                let paragraphElement = document.getElementById('monutil');
                let paragraphContent = paragraphElement.textContent;
                tableBody.empty();  // Vide la table actuelle

                data.forEach(function (item) {
                    notificationCount = data.length;
                    let row = '<tr>';

                    row += '<td>' + item.numero_document + '</td>';
                    row += '<td>' + item.useru + '</td>';

                    row += `<td>`
                    row += '<div class="action-buttons">';

                    row += `<a href="/doc/voir_document_demande/${paragraphContent}/${item.id}" class="btn btn-info btn-icon btn-sm" style="padding: 10px 20px; font-size: 14px; width: 100px;"><i class="bi bi-eye">Voir</i></a>`;
                    if (item.mdir === 1) {


                        row += `<a href="/doc/accepter_per/${item.id_res}/${paragraphContent}" class="btn btn-info btn-icon btn-sm" style="padding: 10px 20px; font-size: 14px; width: 100px;"><i class="bi bi-check">Accepter</i></a>`;
                        row += `<a href="/doc/refuser_per/${item.id_res}/${paragraphContent}" class="btn btn-danger btn-icon btn-sm"><i class="bi bi-eye">Refuser</i></a>`;
                    }
                    if (item.mdir === 0) {
                        row += `<a href="/doc/accepter_non_dir/${item.id_res}/${paragraphContent}" class="btn btn-info btn-icon btn-sm" style="padding: 10px 20px; font-size: 14px; width: 100px;"><i class="bi bi-check"></i>Accepter</a>`;
                        row += `<a href="/doc/refuse_non_dir/${item.id_res}/{paragraphContent}" class="btn btn-danger btn-icon btn-sm" style="padding: 10px 20px; font-size: 14px;" ><i class="bi bi-x">Refuser</i></a>`;
                    }
                    row += '</div>';

                    row += `</td>`

                    row += '</tr>';

                    // Ajout de la ligne au tableau
                    tableBody.append(row);
                });
            }

            ///Recherche
            ///Recherche
//let fetchInterval;
            function filterTable(searchTerm) {
                const tableBody = $("#your-table-id tbody");
                const rows = tableBody.find('tr');

                rows.each(function () {
                    const textContent = $(this).text().toLowerCase();
                    const visible = textContent.indexOf(searchTerm.toLowerCase()) !== -1;
                    $(this).toggle(visible);
                });
            }

            // Event listener for search input
            $("#searchInput").on('keyup', function () {
                const searchTerm = $(this).val();
                filterTable(searchTerm);
            });


            function startFetchingData() {
                fetchData(); // Charger les données initiales
                fetchInterval = setInterval(fetchData, 5000); // 5000ms = 5s
            }


            function stopFetchingData() {
                clearInterval(fetchInterval);


            }

            $("#searchInput").on('keyup', function () {
                if ($("#searchInput").val().trim() !== "") {
                    //
                    stopFetchingData();
                } else {
                    //

                }
                if ($("#searchInput").val().trim() === "") {
                    startFetchingData();
                }


            });


            // Appeler fetchData() pour charger les données initiales
            //fetchData();

            // Optionnel: Actualiser les données toutes les X secondes
            //setInterval(fetchData, 5000); // 30000ms = 30s
            startFetchingData();


            // Function to update notification bar


            // Function to fetch message count from server


            // Periodically fetch and update message count

            function updateNotificationCount() {
                // Update the paragraph content with the notification count
                const notificationBarElement = document.getElementById('notification-bar');
                notificationBarElement.textContent = `${notificationCount}`;
            }

// Update notification count every 100 milliseconds (replace with a suitable interval)
            setInterval(updateNotificationCount, 100);

        });
    </script>


</head>
<body>
<aside class="sidebar" style="background-color: rgb(49, 47, 47);">
    <div class="toggle">
        <a href="#" class="burger js-menu-toggle" data-toggle="collapse" data-target="#main-navbar">
            <span></span>
        </a>
    </div>
    <div class="side-inner">
        <div class="profile">
            <img src="/static/images/imgtra/images/logo.png" alt="Image" class="img-fluid">
        </div>

        <!-- Menu principal -->
        <div class="nav-menu folo">
            <ul>
                <li class="accordion main-menu">

                    <span class="icon-home mr-3"></span>MENU PRINCIPAL

                </li>
            </ul>
        </div>

        <div class="nav-menu">
            <ul>
                {% if util.direction == 'documentation' %}
                    <p></p>

                    <li class="accordion">
                        <a href="#" data-toggle="collapse" data-target="#collapseTransfert" aria-expanded="false"
                           aria-controls="collapseTransfert" class="collapsible">
                            <span class="icon-sync mr-3"></span>DOCUMENTATION
                        </a>
                        <div id="collapseTransfert" class="collapse" aria-labelledby="headingTransfert">
                            <div>
                                <ul>
                                    <li><a href="/doc/listeboite/{{ util.id_utilisateur }}">BOITES</a></li>

                                    <li><a href="/doc/tot_document/{{ util.id_utilisateur }}">DOCUMENTS</a></li>
                                    {% if util.role == 'chef' %}

                                        <li><a href="/doc/listeagent/{{ util.id_utilisateur }}">AGENTS</a></li>
                                        <li><a href="/doc/liste_permission/{{ util.id_utilisateur }}"
                                               style="text-transform: uppercase;">REQUETES Reçues</a></li>
                                    {% endif %}
                                    <li><a href="/doc/liste_mes_demnades/{{ util.id_utilisateur }}">MES
                                        DEMENDES </a></li>
                                    <li><a href="/doc/liste_consultation/{{ util.id_utilisateur }}">MES
                                        CONSULTATION</a></li>


                                </ul>
                            </div>
                        </div>
                    </li>
                {% endif %}
                {% if util.direction == 'facturation' %}

                    <li class="accordion">
                        <a href="#" data-toggle="collapse" data-target="#collapseFacturation" aria-expanded="false"
                           aria-controls="collapseFacturation" class="collapsible">
                            <span class="icon-file-text mr-3"></span>FACTURATION
                        </a>
                        <div id="collapseFacturation" class="collapse" aria-labelledby="headingFacturation">
                            <div>
                                <ul>
                                    {#                                 CREER UTILISATEUR#}
                                    {#                                <li>{{  util.direction }}</li>#}


                                    <li><a href="/doc/listeboite/{{ util.id_utilisateur }}">BOITES</a></li>

                                    <li><a href="/doc/tot_document/{{ util.id_utilisateur }}">DOCUMENTS</a></li>
                                    {% if util.role == 'chef' %}

                                        <li><a href="/doc/listeagent/{{ util.id_utilisateur }}">AGENTS</a></li>
                                        <li><a href="/doc/liste_permission/{{ util.id_utilisateur }}"
                                               style="text-transform: uppercase;">REQUETES Reçues</a></li>
                                    {% endif %}
                                    <li><a href="/doc/liste_mes_demnades/{{ util.id_utilisateur }}"> MES
                                        DEMENDES </a></li>
                                    <li><a href="/doc/liste_consultation/{{ util.id_utilisateur }}">MES
                                        CONSULTATIONS</a></li>
                                </ul>
                            </div>
                        </div>
                    </li>

                {% endif %}


                {% if util.direction == 'archive' %}

                    <li class="accordion">
                    <a href="#" data-toggle="collapse" data-target="#collapseArchive" aria-expanded="false"
                       aria-controls="collapseArchive" class="collapsible">
                        <span class="icon-archive mr-3"></span>ARCHIVE
                    </a>
                    <div id="collapseArchive" class="collapse" aria-labelledby="headingArchive">
                        <div>
                            <ul>

                                <li><a href="/doc/liste_boite_cloture/{{ util.id_utilisateur }}">BOITES
                                    CLOTURÉES</a></li>
                                <li><a href="/doc/liste_boite_classes/{{ util.id_utilisateur }}">BOITTES
                                    CLASSEES</a></li>

                                <!--<li><a href="/doc/listedmd/{{ util.id_utilisateur }}">DEMANDES</a></li>-->
                                <li><a href="/doc/listedemesddemande/{{ util.id_utilisateur }}">CONSULTATIONS</a>
                                </li>
                                <li><a href="/doc/listedmd/{{ util.id_utilisateur }}">CONSULTATIONS</a></li>
                                <!--<li><a href="./list_cartable_archiviste.html">LES CARTABLES CLOTURÉES</a></li>
                                          <li><a href="./list_cartable_archiviste.html">LES CARTABLES CLOTURÉES</a></li>
                                    <li><a href="/doc/listedmd/{{ util.id_utilisateur }}">DEMANDES</a></li>-->
                            </ul>

                        </div>
                    </div>

                {% endif %}


                </li>
                {% if util.direction == 'ADMIN' %}

                    <li class="accordion">
                        <a href="#" data-toggle="collapse" data-target="#collapseDocumentation"
                           aria-expanded="false" aria-controls="collapseDocumentation" class="collapsible">
                            <span class="icon-book mr-3"></span>ADMINISTRATEUR
                        </a>
                        <div id="collapseDocumentation" class="collapse" aria-labelledby="headingDocumentation">
                            <div>
                                <ul>
                                    <li><a href="/doc/listechef/{{ util.id_utilisateur }}">CHEFS SERVICES</a></li>
                                    <!--<li><a href="./list_document_agent_.html">LES DOCUMENTS</a></li>
                                    <li><a href="./list_cartable_agent.html">LES CARTABLES</a></li>
                                    <li><a href="./list_classeur_agent.html">LES CLASSEURS</a></li>-->
                                </ul>
                            </div>
                        </div>
                    </li>
                {% endif %}
                {% if util.direction == 'transfert' %}

                    <li class="accordion">
                        <a href="#" data-toggle="collapse" data-target="#collapseTransfert" aria-expanded="false"
                           aria-controls="collapseTransfert" class="collapsible">
                            <span class="icon-sync mr-3"></span>TRANSFERT
                        </a>
                        <div id="collapseTransfert" class="collapse" aria-labelledby="headingTransfert">
                            <div>
                                <ul>
                                    <li><a href="/doc/listeboite/{{ util.id_utilisateur }}">BOITES</a></li>

                                    <li><a href="/doc/tot_document/{{ util.id_utilisateur }}">DOCUMENTS</a></li>
                                    {% if util.role == 'chef' %}

                                        <li><a href="/doc/listeagent/{{ util.id_utilisateur }}">AGENTS</a></li>
                                        <li><a href="/doc/liste_permission/{{ util.id_utilisateur }}"
                                               style="text-transform: uppercase;">REQUETES Reçcues</a></li>
                                    {% endif %}
                                    <li><a href="/doc/liste_mes_demnades/{{ util.id_utilisateur }}">MES DEMENDES</a>
                                    </li>
                                    <li><a href="/doc/liste_consultation/{{ util.id_utilisateur }}">MES
                                        CONSULTATIONS</a></li>


                                </ul>
                            </div>
                        </div>
                    </li>
                {% endif %}


                {% if util.direction == 'management' %}
                    <li class="accordion">
                        <a href="#" data-toggle="collapse" data-target="#collapseSacherie" aria-expanded="false"
                           aria-controls="collapseSacherie" class="collapsible">
                            <span class="icon-file-text mr-3"></span>Management
                        </a>
                        <div id="collapseSacherie" class="collapse" aria-labelledby="headingSacherie">
                            <div>
                                <ul>
                                    <li><a href="/doc/listecartable/{{ util.id_utilisateur }}">CARTABLE</a></li>
                                    <li><a href="/doc/liste_permission_manage/{{ util.id_utilisateur }}"
                                           style="text-transform: uppercase;">REQUETES Reçues</a></li>

                                    <li><a href="/doc/liste_mes_demnades/{{ util.id_utilisateur }}"> MES
                                        DEMENDES </a></li>


                                </ul>
                            </div>
                        </div>
                    </li>
                {% endif %}
                {% if util.direction == 'sacherie' %}
                    <li class="accordion">
                        <a href="#" data-toggle="collapse" data-target="#collapseSacherie" aria-expanded="false"
                           aria-controls="collapseSacherie" class="collapsible">
                            <span class="icon-file-text mr-3"></span>SACHERIE
                        </a>
                        <div id="collapseSacherie" class="collapse" aria-labelledby="headingSacherie">
                            <div>
                                <ul>
                                    <li><a href="/doc/listeboite/{{ util.id_utilisateur }}">BOITES</a></li>

                                    <li><a href="/doc/tot_document/{{ util.id_utilisateur }}">DOCUMENTS</a></li>
                                    {% if util.role == 'chef' %}

                                        <li><a href="/doc/listeagent/{{ util.id_utilisateur }}">AGENTS</a></li>
                                        <li><a href="/doc/liste_permission/{{ util.id_utilisateur }}"
                                               style="text-transform: uppercase;">MES REQUETES Reçues </a></li>
                                    {% endif %}
                                    <li><a href="/doc/liste_mes_demnades/{{ util.id_utilisateur }}">MES DEMENDES</a>
                                    </li>
                                    <li><a href="/doc/liste_consultation/{{ util.id_utilisateur }}">MES
                                        CONSULTATIONS</a></li>


                                </ul>
                            </div>
                        </div>
                    </li>
                {% endif %}
                {% if util.direction == 'comptabilite' %}
                    <li class="accordion">
                        <a href="#" data-toggle="collapse" data-target="#collapseComptabilite" aria-expanded="false"
                           aria-controls="collapseComptabilite" class="collapsible">
                            <span class="icon-calculator mr-3"></span>COMPTABILITÉ
                        </a>
                        <div id="collapseComptabilite" class="collapse" aria-labelledby="headingComptabilite">
                            <div>
                                <ul>
                                    <li><a href="/doc/listeboite/{{ util.id_utilisateur }}">BOITES</a></li>

                                    <li><a href="/doc/tot_document/{{ util.id_utilisateur }}">DOCUMENTS</a></li>
                                    {% if util.role == 'chef' %}

                                        <li><a href="/doc/listeagent/{{ util.id_utilisateur }}">AGENTS</a></li>
                                        <li><a href="/doc/liste_permission/{{ util.id_utilisateur }}"
                                               style="text-transform: uppercase;">REQUETES Reçcues</a></li>
                                    {% endif %}
                                    <li><a href="/doc/liste_mes_demnades/{{ util.id_utilisateur }}">MES DEMANDE</a>
                                    </li>
                                    <li><a href="/doc/liste_consultation/{{ util.id_utilisateur }}">MES
                                        CONSULTATIONS</a></li>


                                </ul>
                            </div>
                        </div>
                    </li>
                {% endif %}
                <li class="accordion">
                    <a href="#" data-toggle="collapse" data-target="#collapseComptabilite" aria-expanded="false"
                       aria-controls="collapseComptabilite" class="collapsible">
                        <span class="icon-calculator mr-3"></span>Dossiers
                    </a>
                    <div id="collapseComptabilite" class="collapse" aria-labelledby="headingComptabilite">
                        <div>
                            <ul>
                                {% for lst in lst_dos %}

                                    <li>
                                        <a href="/archive/liste_dossier/{{ util.id_utilisateur }}/{{ lst.id_dossier }}">{{ lst.nom }}</a>
                                    </li>
                                {% endfor %}


                            </ul>
                        </div>
                    </div>
                </li>


            </ul>
        </div>
    </div>
</aside>


<main>
    <div class="header">
        <div class="header-content d-flex justify-content-between align-items-center py-3 px-4">
            <!-- Barre de recherche à gauche -->
            <div class="d-flex align-items-center" style="width: 55%;">
                <input class="form-control" id="myInputGlobalSearch" type="text" onkeyup="filterTable()"
                       placeholder="Global Search">
                <!--<form class="form-inline my-2" style="width: 100%;" sty>
                    <input class="form-control mr-2 search-bar w-100" type="search" placeholder="Search" aria-label="Search">
                </form>-->
            </div>
            {% if util.role == 'chef' %}
                <div class="d-flex align-items-center">

                    <a


                            href="/doc/liste_permission/{{ util.id_utilisateur }}"
                            id="navbarDropdownMenuLink"
                            role="button"
                            aria-expanded="false"
                    >
                        <i class="fas fa-bell" style="color: black"></i>
                        <span class="badge rounded-pill badge-notification bg-danger" id="notification-bar"></span>
                    </a>

                </div>
            {% endif %}
            <div class="d-flex align-items-center">

                <div class="text-right text-white mr-3">
                    <p style="color: black" class="mb-0">{{ util.nom }} {{ util.prenom }}</p>
                    <p style="color: black" class="mb-0">{{ util.direction }}</p>
                    <a style="color: red" href="/doc/deconnexion/">Se Déconnecter</a>
                </div>
                <img src="/static/images/imgtra/images/logo1.png" alt="Profile Image"
                     class="rounded-circle profile-img" style="width: 80px; height: 80px;">
            </div>
        </div>

    </div>
    <div class="site-section">
        {#% if util.direction == 'ADMIN' %#}
        <button class="btn btn-info btn-icon btn-sm" style="padding: 10px 20px; font-size: 14px; width: 100px;"
                data-toggle="modal" data-target="#ajouterDossierModal"
                data-iduser="{{ util.id_user }}" data-iddossier="{{ dossier_crt.id_dossier }}">
            <i class="bi bi-plus-lg"></i> Nouveau Dossier
        </button>
        {#% else %#}
        <button class="btn btn-info btn-icon btn-sm" style="padding: 10px 20px; font-size: 14px; width: 100px;"
                data-toggle="modal" data-target="#ajouterdocumentModal"
                data-iduser="{{ util.id_user }}" data-iddossier="{{ dossier_crt.id_dossier }}">
            <i class="bi bi-plus-lg"></i> Nouveau Document
        </button>

        {#% endif %#}
        <div style="display: flex; justify-content: center; width: 100%;">

            <main style="width: 100%;">


                <div class="site-section">

                    <div class="container">

                        <p>Tapez un mot à rechercher</p>
                        <input class="form-control" id="myInput" type="text" onkeyup="filterTable()"
                               placeholder="Search..">
                        <br>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                {% for dossier in arborescence %}
                                    <li class="breadcrumb-item">
                                        <a href="/archive/liste_dossier/{{ util.id_user }}/{{ dossier.id_dossier }}"
                                           style="color: black">
                                            {{ dossier.nom }}
                                        </a>
                                    </li>
                                {% endfor %}
                            </ol>
                        </nav>
                        <!--------Recherche -->
                        <!--h2>Filterable Cards</h2-->


                        <br><br>
                        <script>
                $(document).ready(function () {
    // Masquer le contenu global initialement
    $(".contenus-globals .card").hide();

    // Gestion de la recherche globale
    $("#myInputGlobalSearch").on("keyup", function () {
        var value = $(this).val().toLowerCase().trim();

        if (value) {
            // Masquer le contenu courant
            $(".contenus-courants").hide();

            // Afficher ou masquer les cartes dans le contenu global
            $(".contenus-globals .card").each(function () {
                var isVisible = $(this).find(".card-text").toArray().some(function (element) {
                    return $(element).text().toLowerCase().indexOf(value) > -1;
                });
                $(this).toggle(isVisible);
            });
        } else {
            // Masquer le contenu global et afficher le contenu courant
            $(".contenus-globals .card").hide();
            $(".contenus-courants").show();
        }
    });

    // Gestion de la recherche courante
    $("#myInput").on("keyup", function () {
        var value = $(this).val().toLowerCase().trim();

        $(".contenus-courants .card").each(function () {
            var isVisible = $(this).find(".card-text").toArray().some(function (element) {
                return $(element).text().toLowerCase().indexOf(value) > -1;
            });
            $(this).toggle(isVisible);
        });
    });
});


                        </script>
                        <div class="d-flex flex-wrap" style="gap: 1rem;">
                            <div class="contenus-courants">
                                {% for ldos in lst_dos %}
                                    <div class="card" style="width: 8rem; height: auto;">
                                        <small style="position: absolute; top: 10px; right: 10px;">
                                            <button type="button" class="btn  p-0 open-modal" style="color: black"
                                                    data-toggle="modal"
                                                    data-target="#detailModal" data-nom="{{ ldoc.nom }}"
                                                    data-numero-document="{{ ldoc.numero_document }}"
                                                    data-date-creation="{{ ldoc.date_creation }}"
                                                    data-eta="{{ ldoc.eta }}"
                                                    data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                    data-vessel="{{ ldoc.vessel }}"
                                                    data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                    data-journal="{{ ldoc.journal }}"
                                                    data-montant="{{ ldoc.montant }}">
                                                <i class="fas fa-info-circle"></i>
                                            </button>
                                            <button type="button" class="btn  p-0 optionsdossiers" style="color: black"
                                                    data-toggle="modal"
                                                    data-target="#optionsdossier" data-nom="{{ ldos.nom }}"
                                            >
                                                <i class="fas fa-ellipsis-v"></i>
                                            </button>
                                        </small>
                                        <a href="/archive/liste_dossier/{{ util.id_user }}/{{ ldos.id_dossier }}"
                                           class="{% if ldos.acces == 1 %}disabled-link{% endif %}">
                                            <img class="card-img-top" src="/static/images/imgtra/image-dossier.jpg"
                                                 alt="Card image cap" style="width: 5rem; height: 5rem;">
                                            <div class="card-body">
                                                <p class="card-text">{{ ldos.nom }}</p>
                                            </div>
                                        </a>
                                        <div class="card-buttons">



                                        </div>
                                    </div>
                                    <!---------------------Options Dossier ----------------->
                                    <div class="modal fade" id="optionsdossier" tabindex="-1" role="dialog"
                                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Options Dossier</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <a href="/archive/restraindre_page/{{ util.id_user }}/{{ ldos.id_dossier }}/dossier"
                                                       class="btn btn-danger btn-sm"><i class="bi bi-x"></i>Restreindre</a>
                                                    <button class="btn btn-info btn-sm" data-toggle="modal"
                                                            data-target="#demandepermissiondossier"
                                                            data-iduser="{{ util.id_user }}"
                                                            data-iddossier="{{ ldos.id_dossier }}"
                                                            data-objet="{{ ldos.id_dossier }}">
                                                        <i class="bi bi-plus-lg">Permission</i>
                                                    </button>

                                                    <button class="btn btn-info btn-sm" type="button"
                                                            class="btn btn-link p-0 open-modal" data-toggle="modal"
                                                            data-target="#detailModal" data-nom="{{ ldoc.nom }}"
                                                            data-numero-document="{{ ldoc.numero_document }}"
                                                            data-date-creation="{{ ldoc.date_creation }}"
                                                            data-eta="{{ ldoc.eta }}"
                                                            data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                            data-vessel="{{ ldoc.vessel }}"
                                                            data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                            data-journal="{{ ldoc.journal }}"
                                                            data-montant="{{ ldoc.montant }}">
                                                        <i class="fas fa-info-circle"> Details</i>
                                                    </button>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}

                                {% for ldoc in lst_doc %}
                                    <div class="card" style="width: 8rem; height: auto;">
                                        {% if ldoc.acces == 0 or 1 %}
                                            <small style="position: absolute; top: 10px; right: 10px;">
                                                <button type="button" class="btn  p-0 open-modal" style="color: black"
                                                        data-toggle="modal"
                                                        data-target="#detailModal" data-nom="{{ ldoc.nom }}"
                                                        data-numero-document="{{ ldoc.numero_document }}"
                                                        data-date-creation="{{ ldoc.date_creation }}"
                                                        data-eta="{{ ldoc.eta }}"
                                                        data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                        data-vessel="{{ ldoc.vessel }}"
                                                        data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                        data-journal="{{ ldoc.journal }}"
                                                        data-montant="{{ ldoc.montant }}">
                                                    <i class="fas fa-info-circle"></i>
                                                </button>
                                                <button type="button" class="btn  p-0 open-modal" style="color: black"
                                                        data-toggle="modal"
                                                        data-target="#options" data-nom="{{ ldoc.nom }}"
                                                        data-numero-document="{{ ldoc.numero_document }}"
                                                        data-date-creation="{{ ldoc.date_creation }}"
                                                        data-eta="{{ ldoc.eta }}"
                                                        data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                        data-vessel="{{ ldoc.vessel }}"
                                                        data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                        data-journal="{{ ldoc.journal }}"
                                                        data-montant="{{ ldoc.montant }}">
                                                    <i class="fas fa-ellipsis-v"></i>
                                                </button>
                                            </small>
                                        {% endif %}

                                        <a href="/archive/affiche_document/{{ util.id_user }}/{{ ldoc.id_document }}"
                                           class="{% if ldoc.acces == 1 %} disabled-link {% endif %}"
                                        >
                                            <img class="card-img-top" src="/static/images/imgtra/image-fichier.jpg"
                                                 alt="Card image cap" style="width: 6rem; height: 6rem;">
                                            <div class="card-body">
                                                <p class="card-text">{{ ldoc.nom }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.nom }}</p>
                                                <p style="display: none;"
                                                   class="card-text">{{ ldoc.numero_document }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.date_creation }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.eta }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.bl }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.client }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.vessel }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.numero_voyage }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.journal }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.montant }}</p>
                                            </div>
                                        </a>
                                        <div class="card-buttons">

                                            {% if util.role == 'chef' %}
                                                <a href="/archive/restraindre_page/{{ util.id_user }}/{{ ldoc.id_document }}/document"
                                                   class="btn btn-danger btn-sm"><i class="bi bi-x"></i></a>
                                            {% endif %}
                                            {% if ldoc.acces == 1 and ldoc.etat == 0 %}
                                                <button class="btn btn-info btn-sm" data-toggle="modal"
                                                        data-target="#demandepermissiondocument"
                                                        data-iduser="{{ util.id_user }}"
                                                        data-iddossier="{{ ldoc.id_document }}"
                                                        data-objet="{{ ldoc.id_document }}">
                                                    <i class="bi bi-plus-lg"></i>
                                                </button>
                                            {% endif %}
                                            {% if ldoc.etat == 0 %}
                                                <p>Demande en Cours</p>
                                            {% endif %}
                                        </div>
                                    </div>


                                    <!-- Modal Demande Permission Dossier -->
                                    <div class="modal fade" id="options" tabindex="-1" role="dialog"
                                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Options Document</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <a href="/archive/restraindre_page/{{ util.id_user }}/{{ ldoc.id_document }}/document"
                                                       class="btn btn-danger btn-sm"><i class="bi bi-x"></i>Restreindre</a>
                                                    <button class="btn btn-info btn-sm" data-toggle="modal"
                                                            data-target="#demandepermissiondocument"
                                                            data-iduser="{{ util.id_user }}"
                                                            data-iddossier="{{ ldoc.id_document }}"
                                                            data-objet="{{ ldoc.id_document }}">
                                                        <i class="bi bi-plus-lg">Permission</i>
                                                    </button>

                                                    <button class="btn btn-info btn-sm" type="button"
                                                            class="btn btn-link p-0 open-modal" data-toggle="modal"
                                                            data-target="#detailModal" data-nom="{{ ldoc.nom }}"
                                                            data-numero-document="{{ ldoc.numero_document }}"
                                                            data-date-creation="{{ ldoc.date_creation }}"
                                                            data-eta="{{ ldoc.eta }}"
                                                            data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                            data-vessel="{{ ldoc.vessel }}"
                                                            data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                            data-journal="{{ ldoc.journal }}"
                                                            data-montant="{{ ldoc.montant }}">
                                                        <i class="fas fa-info-circle"> Details</i>
                                                    </button>

                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                {% endfor %}
                            </div>

                            <div class="contenus-globals">

                                {% for ldoc in tout_doc %}
                                    <p style="display: none;color: blanchedalmond" id="mondoc">37</p>
                                    <div class="card" style="width: 8rem; height: auto;">
                                        <small style="position: absolute; top: 10px; right: 10px;">
                                            <button type="button" class="btn  p-0 open-modal" style="color: black"
                                                    data-toggle="modal"
                                                    data-target="#detailModal" data-nom="{{ ldoc.nom }}"
                                                    data-numero-document="{{ ldoc.numero_document }}"
                                                    data-date-creation="{{ ldoc.date_creation }}"
                                                    data-eta="{{ ldoc.eta }}"
                                                    data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                    data-vessel="{{ ldoc.vessel }}"
                                                    data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                    data-journal="{{ ldoc.journal }}"
                                                    data-montant="{{ ldoc.montant }}">
                                                <i class="fas fa-info-circle"></i>
                                            </button>
                                            <button type="button" class="btn  p-0 open-modal" style="color: black"
                                                    data-toggle="modal"
                                                    data-target="#optionstout" data-nom="{{ ldoc.nom }}"
                                                    data-numero-document="{{ ldoc.numero_document }}"
                                                    data-date-creation="{{ ldoc.date_creation }}"
                                                    data-eta="{{ ldoc.eta }}"
                                                    data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                    data-vessel="{{ ldoc.vessel }}"
                                                    data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                    data-journal="{{ ldoc.journal }}"
                                                    data-montant="{{ ldoc.montant }}">
                                                <i class="fas fa-ellipsis-v"></i>
                                            </button>
                                        </small>
                                        <a href="/archive/affiche_document/{{ util.id_user }}/{{ ldoc.id_document }}"
                                           class="{% if ldoc.acces == 1 %}disabled-link{% endif %}"
                                        >
                                            <img class="card-img-top" src="/static/images/imgtra/image-fichier.jpg"
                                                 alt="Card image cap" style="width: 7rem; height: 7rem;">
                                            <div class="card-body">
                                                <p class="card-text">{{ ldoc.nom }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.nom }}</p>
                                                <p style="display: none;"
                                                   class="card-text">{{ ldoc.numero_document }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.date_creation }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.eta }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.bl }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.client }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.vessel }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.numero_voyage }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.journal }}</p>
                                                <p style="display: none;" class="card-text">{{ ldoc.montant }}</p>
                                            </div>
                                        </a>

                                    </div>
                                    <!---------------------Options ----------------->
                                    <div class="modal fade" id="optionstout" tabindex="-1" role="dialog"
                                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Options</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <a href="/archive/restraindre_page/{{ util.id_user }}/{{ ldoc.id_document }}/document"
                                                       class="btn btn-danger btn-sm"><i class="bi bi-x"></i>Restreindre</a>
                                                    <button class="btn btn-info btn-sm" data-toggle="modal"
                                                            data-target="#demandepermissiondocument"
                                                            data-iduser="{{ util.id_user }}"
                                                            data-iddossier="{{ ldoc.id_document }}"
                                                            data-objet="{{ ldoc.id_document }}">
                                                        <i class="bi bi-plus-lg">Permission</i>
                                                    </button>

                                                    <button class="btn btn-info btn-sm" type="button"
                                                            class="btn btn-link p-0 open-modal" data-toggle="modal"
                                                            data-target="#detailModal" data-nom="{{ ldoc.nom }}"
                                                            data-numero-document="{{ ldoc.numero_document }}"
                                                            data-date-creation="{{ ldoc.date_creation }}"
                                                            data-eta="{{ ldoc.eta }}"
                                                            data-bl="{{ ldoc.bl }}" data-client="{{ ldoc.client }}"
                                                            data-vessel="{{ ldoc.vessel }}"
                                                            data-numero-voyage="{{ ldoc.numero_voyage }}"
                                                            data-journal="{{ ldoc.journal }}"
                                                            data-montant="{{ ldoc.montant }}">
                                                        <i class="fas fa-info-circle"> Details</i>
                                                    </button>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>


                        <!----------------Modale Ajout Documnet ------------------>

                        <!-- Modal Structure -->
                        <div class="modal fade" id="ajouterdocumentModal" tabindex="-1" role="dialog"
                             aria-labelledby="exampleModalLabel"
                             aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLabel">Ajouter Document</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <form method="POST" action="/archive/ajouter_document/"
                                                  enctype="multipart/form-data">
                                                {% csrf_token %}
                                                <input name="id_user" type="hidden" id="id_user_input"
                                                       placeholder="ID User" required>
                                                <input name="id_parent" type="hidden" id="id_dossier_input"
                                                       placeholder="ID Dossier" required>

                                                <div class="form-row">
                                                    <div class="col-md-6 mb-3">
                                                        <label for="numero">Identifiant</label>
                                                        <input type="text" name="numero" id="numero"
                                                               class="form-control form-control-lg"
                                                               placeholder="Identifiant" required/>
                                                        {% if message %}
                                                            <p style="color: red">{{ message }}</p>
                                                        {% endif %}
                                                    </div>

                                                    <div class="col-md-6 mb-3">
                                                        <label for="bl">BL</label>
                                                        <input type="text" name="bl" id="bl"
                                                               class="form-control form-control-lg" placeholder="BL"/>
                                                        {% if messagebl %}
                                                            <p style="color: red">{{ messagebl }}</p>
                                                        {% endif %}
                                                    </div>
                                                </div>

                                                <div class="form-row">
                                                    <div class="col-md-6 mb-3">
                                                        <label for="montant">Montant</label>
                                                        <input type="number" name="montant" id="montant"
                                                               class="form-control form-control-lg"
                                                               placeholder="Montant"/>
                                                    </div>

                                                    <div class="col-md-6 mb-3">
                                                        <label for="journal">Journal</label>
                                                        <input type="text" name="journal" id="journal"
                                                               class="form-control form-control-lg"
                                                               placeholder="Journal"/>
                                                    </div>
                                                </div>

                                                <div class="form-row">
                                                    <div class="col-md-6 mb-3">
                                                        <label for="eta">ETA</label>
                                                        <input type="date" name="eta" id="eta"
                                                               class="form-control form-control-lg" placeholder="ETA"/>
                                                    </div>
                                                    <div class="col-md-6 mb-3">
                                                        <label for="client">Client</label>
                                                        <input type="text" name="client" id="client"
                                                               class="form-control form-control-lg"
                                                               placeholder="Client"/>
                                                    </div>
                                                </div>

                                                <div class="form-row">
                                                    <div class="col-md-6 mb-3">
                                                        <label for="navire">Vessel</label>
                                                        <input type="text" name="navire" id="navire"
                                                               class="form-control form-control-lg"
                                                               placeholder="Vessel"/>
                                                    </div>
                                                    <div class="col-md-6 mb-3">
                                                        <label for="voyage">Numero Voyage</label>
                                                        <input type="text" name="voyage" id="voyage"
                                                               class="form-control form-control-lg"
                                                               placeholder="Numero Voyage"/>
                                                    </div>
                                                </div>

                                                <div class="form-row">
                                                    <div class="col-md-12 mb-3">
                                                        <label for="file">Charger le fichier</label>
                                                        <input type="file" name="fichier" id="file"
                                                               class="form-control form-control-lg" required/>
                                                    </div>
                                                </div>

                                                <div class="modal-footer d-flex justify-content-center align-items-center"
                                                     style="gap: 10px;">
                                                    <button type="button" class="btn-danger" data-dismiss="modal"
                                                            style="padding: 10px 20px; background-color: red; color: white; border: none; border-radius: 4px;">
                                                        Fermer
                                                    </button>
                                                    <button type="submit" class="btn-info"
                                                            style="padding: 10px 20px;  border: none; border-radius: 4px;">
                                                        Enregistrer
                                                    </button>
                                                </div>

                                            </form>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Structure -->
                    <div class="modal fade" id="ajouterDossierModal" tabindex="-1" role="dialog"
                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Ajouter Dossier</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>

                                <div class="modal-body">
                                    <form method="POST" action="/archive/ajouter_dossier/">
                                        <input name="id_user" type="hidden" id="id_user_input" placeholder="ID User">
                                        <input name="id_parent" type="hidden" id="id_dossier_input"
                                               placeholder="ID Dossier">
                                        <!-- Ajoutez d'autres champs nécessaires -->
                                        <div class="form-group mb-4">
                                            <label for="direction">Direction</label>
                                            <select id="direction" name="direction" class="form-control form-control-lg"
                                                    required>
                                                <option value="">Sélectionnez une direction</option>
                                                <option value="facturation">Facturation</option>
                                                <option value="documentation">Documentation</option>
                                                <!-- Ajoutez d'autres options ici si nécessaire -->
                                            </select>
                                        </div>

                                        <div class="form-group mb-4">
                                            {% csrf_token %}
                                            <label for="mentions">Nom</label>
                                            <input type="text" name="nom" id="mentions"
                                                   class="form-control form-control-lg"
                                                   placeholder="Nom"/>

                                            {% if message %}
                                                <p style="color: red">{{ message }}</p>
                                            {% endif %}
                                        </div>

                                        <div class="modal-footer d-flex justify-content-center align-items-center"
                                             style="gap: 10px;">
                                            <button type="button" class="btn-danger" data-dismiss="modal"
                                                    style="padding: 10px 20px; background-color: red; color: white; border: none; border-radius: 4px;">
                                                Fermer
                                            </button>
                                            <button type="submit" class="btn-info"
                                                    style="padding: 10px 20px;  border: none; border-radius: 4px;">
                                                Enregistrer
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Icône pour ouvrir le modal -->


                    <!-- Modal Bootstrap -->


                    <!-- Modal Bootstrap -->
                    <div class="modal fade" id="detailModal" tabindex="-1" role="dialog"
                         aria-labelledby="detailModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="detailModalLabel">Détails du Document</h5>

                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">

                                    <form id="modalForm">
                                        <div class="form-group">
                                            <p id="arborescence" style="color:black">Test Paragraphe</p>
                                        </div>
                                        <div class="form-group">
                                            <label for="nomDocument">Nom</label>
                                            <input type="text" class="form-control" id="nomDocument" name="nom">
                                        </div>
                                        <div class="form-group">
                                            <label for="numeroDocument">Numéro</label>
                                            <input type="text" class="form-control" id="numeroDocument"
                                                   name="numero_document">
                                        </div>
                                        <div class="form-group">
                                            <label for="dateCreation">Date de Création</label>
                                            <input type="text" class="form-control" id="dateCreation"
                                                   name="date_creation">
                                        </div>
                                        <div class="form-group">
                                            <label for="eta">ETA</label>
                                            <input type="text" class="form-control" id="eta" name="eta">
                                        </div>
                                        <div class="form-group">
                                            <label for="bl">BL</label>
                                            <input type="text" class="form-control" id="bl" name="bl">
                                        </div>
                                        <div class="form-group">
                                            <label for="client">Client</label>
                                            <input type="text" class="form-control" id="client" name="client">
                                        </div>
                                        <div class="form-group">
                                            <label for="vessel">Vessel</label>
                                            <input type="text" class="form-control" id="vessel" name="vessel">
                                        </div>
                                        <div class="form-group">
                                            <label for="numeroVoyage">Numéro de Voyage</label>
                                            <input type="text" class="form-control" id="numeroVoyage"
                                                   name="numero_voyage">
                                        </div>
                                        <div class="form-group">
                                            <label for="journal">Journal</label>
                                            <input type="text" class="form-control" id="journal" name="journal"
                                                   placeholder="Journal">
                                        </div>
                                        <div class="form-group">
                                            <label for="montant">Montant</label>
                                            <input type="text" class="form-control" id="montant" name="montant"
                                                   placeholder="Montant">
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer d-flex justify-content-center align-items-center"
                                     style="gap: 10px;">
                                    <button type="button" class="btn btn-danger mx-2" data-dismiss="modal"
                                            style="height: 50px;">Fermer
                                    </button>
                                    <button type="submit" class="btn btn-info mx-2" style="height: 50px;">Enregistrer
                                    </button>
                                </div>


                            </div>
                        </div>
                    </div>

                    <!-- Inclure les scripts de Bootstrap et jQuery -->
                    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
                    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

                    <script>
                        $('#detailModal').on('show.bs.modal', function (event) {
                            var button = $(event.relatedTarget); // Bouton qui a déclenché le modal
                            var modal = $(this);

                            // Remplir les champs du modal avec les données du bouton
                            modal.find('#nomDocument').val(button.data('nom'));
                            modal.find('#numeroDocument').val(button.data('numero-document'));
                            modal.find('#dateCreation').val(button.data('date-creation'));
                            modal.find('#eta').val(button.data('eta'));
                            modal.find('#bl').val(button.data('bl'));
                            modal.find('#client').val(button.data('client'));
                            modal.find('#vessel').val(button.data('vessel'));
                            modal.find('#numeroVoyage').val(button.data('numero-voyage'));
                            modal.find('#journal').val(button.data('journal'));
                            modal.find('#montant').val(button.data('montant'));
                        });
                    </script>
                    <!---------fin Script ------------------>
                    <!----------------Ajout Access -------------------->

                    <div class="modal fade" id="ajouterAccesModal" tabindex="-1" role="dialog"
                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Ajouter Dossier</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" action="/archive/ajout_acces/">
                                        <input name="id_util" type="text" id="id_user_input" placeholder="ID User">
                                        <input name="id_parent" type="text" id="id_dossier_input"
                                               placeholder="ID Dossier">
                                        <input name="objet" type="text" id="objet" placeholder="objet" value="dossier">

                                        {% csrf_token %}

                                        <div class="form-group mb-4">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th scope="col">Prénom</th>
                                                    <th scope="col">Nom</th>
                                                    <th scope="col" class="col-3">Selection</th>
                                                </tr>
                                                </thead>
                                                <tbody>

                                                {% for agt in agt_dir %}
                                                    <tr>
                                                        <td>{{ agt.prenom }}</td>
                                                        <td>{{ agt.nom }}</td>
                                                        <td class="col-2">
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox"
                                                                       name="agt" id="agt-{{ agt.id_utilisateur }}"
                                                                       value="{{ agt.id_utilisateur }}">
                                                            </div>
                                                        </td>
                                                    </tr>
                                                {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">
                                                Fermer
                                            </button>
                                            <button type="submit" class="btn btn-primary">Enregistrer</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Demande Permission Dossier -->
                    <div class="modal fade" id="demandepermissiondossier" tabindex="-1" role="dialog"
                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Demande De Permission</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" action="/archive/ajouter_permission/">
                                        <input name="id_user" type="text" id="id_user_input" placeholder="ID User"
                                               value="{{ util.id_user }}">
                                        <input name="type" type="text" placeholder="dossier" value="dossier">
                                        <input name="objet" type="text" id="objet" placeholder="Objet">
                                        <!-- Ajoutez d'autres champs nécessaires -->

                                        <div class="form-group mb-4">
                                            {% csrf_token %}
                                            <label for="mentions">Commentaire</label>
                                            <input type="text" name="commentaire" id="commentaire"
                                                   class="form-control form-control-lg" placeholder="Commentaire"/>

                                            {% if message %}
                                                <p style="color: red">{{ message }}</p>
                                            {% endif %}
                                        </div>
                                        <div class="modal-footer d-flex justify-content-center align-items-center"
                                             style="gap: 10px;">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">
                                                Fermer
                                            </button>
                                            <button type="submit" class="btn btn-primary">Enregistrer</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--------Modale Permission dOcument----------------->


                    <!-- Modal Demande Permission Dossier -->
                    <div class="modal fade" id="demandepermissiondocument" tabindex="-1" role="dialog"
                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">`
                                    <h5 class="modal-title" id="exampleModalLabel">Demande De Permission</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form method="POST" action="/archive/ajouter_permission/">
                                        <input name="id_user" type="text" id="id_user_input" placeholder="ID User"
                                               value="{{ util.id_user }}">
                                        <input name="id_parent" type="text" id="id_dossier_input"
                                               placeholder="ID Dossier">
                                        <input name="objet" type="text" id="objet" placeholder="Objet">
                                        <input name="type" type="text" id="type" placeholder="type" value="document">
                                        <!-- Ajoutez d'autres champs nécessaires -->

                                        <div class="form-group mb-4">
                                            {% csrf_token %}
                                            <label for="mentions">Commentaire</label>
                                            <input type="text" name="commentaire" id="commentaire"
                                                   class="form-control form-control-lg" placeholder="Commentaire"/>

                                            {% if message %}
                                                <p style="color: red">{{ message }}</p>
                                            {% endif %}
                                        </div>
                                        <div class="modal-footer justify-content-between">
                                            <button type="button" class="btn-secondary" data-dismiss="modal"
                                                    style="padding: 10px 20px; background-color: red; color: white; border: none; border-radius: 4px;">
                                                Fermer
                                            </button>
                                            <button type="submit" class="btn-info"
                                                    style="padding: 10px 20px;  border: none; border-radius: 4px;">
                                                Enregistrer
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>


            </main>
            <script>
                function filterTable() {
                    // Déclaration des variables
                    var input, filter, table, tr, td, i, j, txtValue;
                    input = document.getElementById("searchInput");
                    filter = input.value.toLowerCase();
                    table = document.getElementById("dataTable");
                    tr = table.getElementsByTagName("tr");

                    // Boucle sur toutes les lignes du tableau, sauf l'en-tête
                    for (i = 1; i < tr.length; i++) {
                        tr[i].style.display = "none"; // Cache la ligne par défaut
                        td = tr[i].getElementsByTagName("td");
                        // Boucle sur toutes les cellules de la ligne courante
                        for (j = 0; j < td.length; j++) {
                            if (td[j]) {
                                txtValue = td[j].textContent || td[j].innerText;
                                if (txtValue.toLowerCase().indexOf(filter) > -1) {
                                    tr[i].style.display = ""; // Affiche la ligne si une cellule correspond
                                    break; // Sort de la boucle pour passer à la ligne suivante
                                }
                            }
                        }
                    }
                }
            </script>

            <script>
                $(document).ready(function () {
                    $("#myInput").on("keyup", function () {
                        var value = $(this).val().toLowerCase();
                        $("#myTable tr").filter(function () {
                            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                        });
                    });
                });
            </script>
            <!-- modale------------>

            <script src="/static/assets/js/jstra/js/jquery-3.3.1.min.js"></script>
            <script src="/static/assets/js/jstra/js/popper.min.js"></script>
            <script src="/static/assets/js/jstra/js/bootstrap.min.js"></script>
            <script src="/static/assets/js/jstra/js/main.js"></script>
            <!--Aajouter Permission ---->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

            <script>
                $(document).ready(function () {
                    $('#demandepermissiondossier').on('show.bs.modal', function (event) {
                        var button = $(event.relatedTarget); // Bouton qui a déclenché le modal
                        var idUser = button.data('iduser'); // Récupérer la valeur de data-iduser
                        var idDossier = button.data('iddossier');
                        var objet = button.data('objet');// Récupérer la valeur de data-iddossier

                        // Insérer les valeurs dans les inputs du modal
                        var modal = $(this);
                        modal.find('#id_user_input').val(idUser);
                        //modal.find('#id_dossier_input').val(idDossier);
                        modal.find('#objet').val(idDossier);
                    });
                });

            </script>

            <!-----------Ajouter Permission Doocument--------------->
            <!--Aajouter Permission ---->
            <script>
                $(document).ready(function () {
                    $('#demandepermissiondocument').on('show.bs.modal', function (event) {
                        var button = $(event.relatedTarget); // Bouton qui a déclenché le modal
                        var idUser = button.data('iduser'); // Récupérer la valeur de data-iduser
                        var idDossier = button.data('iddossier');
                        var objet = button.data('objet');// Récupérer la valeur de data-iddossier

                        // Insérer les valeurs dans les inputs du modal
                        var modal = $(this);
                        modal.find('#id_user_input').val(idUser);
                        modal.find('#id_dossier_input').val(idDossier);
                        modal.find('#objet').val(objet);
                    });
                });

            </script>
            <script>
                $(document).ready(function () {
                    $('#ajouterDossierModal').on('show.bs.modal', function (event) {
                        var button = $(event.relatedTarget); // Bouton qui a déclenché le modal
                        var idUser = button.data('iduser'); // Récupérer la valeur de data-iduser
                        var idDossier = button.data('iddossier'); // Récupérer la valeur de data-iddossier

                        // Insérer les valeurs dans les inputs du modal
                        var modal = $(this);
                        modal.find('#id_user_input').val(idUser);
                        modal.find('#id_dossier_input').val(idDossier);
                    });
                });

            </script>
            <!--mOdale Ajout Documnet -->
            <script src="/static/assets/js/jstra/js/jquery-3.3.1.min.js"></script>
            <script src="/static/assets/js/jstra/js/popper.min.js"></script>
            <script src="/static/assets/js/jstra/js/bootstrap.min.js"></script>
            <script src="/static/assets/js/jstra/js/main.js"></script>
            <script>
                $(document).ready(function () {
                    $('#ajouterdocumentModal').on('show.bs.modal', function (event) {
                        var button = $(event.relatedTarget); // Bouton qui a déclenché le modal
                        var idUser = button.data('iduser'); // Récupérer la valeur de data-iduser
                        var idDossier = button.data('iddossier'); // Récupérer la valeur de data-iddossier

                        // Insérer les valeurs dans les inputs du modal
                        var modal = $(this);
                        modal.find('#id_user_input').val(idUser);
                        modal.find('#id_dossier_input').val(idDossier);
                    });
                });

            </script>
            <!------------Script Arbo --------->
            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
            <script>
                function fetchArborescence() {
                    const paragraphElement = document.getElementById('mondoc');
                    const paragraphContent = paragraphElement.textContent;

                    $.ajax({
                        url: '/archive/fetch_arborescence/18',
                        method: "GET",
                        data: {id_dos: paragraphContent},
                        success: function (response) {
                            if (response.data) {
                                const arborescence = response.data.reverse().join(' > '); // Joignez les éléments par ' > ' ou tout autre séparateur
                                $('#arborescence').text(arborescence);
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error('Error fetching data:', error);
                        }
                    });
                }

                $(document).ready(function () {
                    fetchArborescence(); // Fetch initially
                    setInterval(fetchArborescence, 500); // Fetch every 10 seconds
                });
            </script>


</body>
</html>